% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/run_highSpaClone.R
\name{suggest_k}
\alias{suggest_k}
\title{Suggest the number of subclones (K) using average silhouette}
\usage{
suggest_k(
  obj,
  ref,
  ref.id = NULL,
  tumor,
  tumor.id = NULL,
  k_range = 2:8,
  n_sub = 10000,
  alpha = 0.7,
  seed = 123,
  out_dir = "figs_k"
)
}
\arguments{
\item{obj}{a highSpaClone object}

\item{ref}{Character vector of \strong{reference (normal)} cell labels.}

\item{ref.id}{Character vector of reference \strong{cell IDs}.}

\item{tumor}{Character vector of \strong{tumor} cell labels.}

\item{tumor.id}{Character vector of tumor \strong{cell IDs}.
If both tumor label/IDs are absent, all non-reference cells are used.}

\item{k_range}{Integer vector of K values to evaluate.}

\item{n_sub}{Integer. Max number of cells to subsample for evaluation (default: 10000).}

\item{alpha}{\code{NULL} for CNV-only. If a number in \code{[0,1]},
fuse CNV and spatial distances: \eqn{d = alpha * d_{CNV} + (1-alpha) * d_{spatial}} (default: 0.7).}

\item{seed}{Integer seed for reproducibility.}

\item{out_dir}{Output directory for figures.}
}
\description{
Computes a recommendation for the number of subclones \code{K}
using the average silhouette on an MDS embedding derived from CNV data.
Optionally fuses spatial distances from \code{obj@location} with CNV distances
(weight \code{alpha}) before embedding. Saves two figures and prints the
silhouette-vs-K plot to the device. Pick \code{K} that obtaions the largest average silhoutte score.
}
\details{
Two figures are saved to \code{out_dir}:
\itemize{
\item \code{silhouette_vs_k.png}: Average silhouette vs \code{K}.
\item \code{silhouette_bars_k_recommended.png}: Silhouette bars at the recommended \code{K}.
}
}
\seealso{
\code{\link[cluster]{silhouette}}, \code{\link[stats]{cmdscale}}, \code{\link[stats]{kmeans}}
}
