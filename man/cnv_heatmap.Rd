% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot.R
\name{cnv_heatmap}
\alias{cnv_heatmap}
\title{Chromosome-binned CNV heatmap with group annotations}
\usage{
cnv_heatmap(
  cnv.obj,
  groupby = "cell.label",
  color_panel = c("#ffadad", "#ffd6a5", "#fdffb6", "#caffbf", "#9bf6ff", "#a0c4ff",
    "#bdb2ff", "#ffc6ff"),
  min_value = -3,
  max_value = 3,
  show = TRUE,
  save = FALSE,
  outfile = "cnv_heatmap.pdf",
  auto_size = TRUE,
  width_in = 10,
  height_in = 6,
  res = 300,
  ...
)
}
\arguments{
\item{cnv.obj}{A list-like object with components:
\itemize{
\item \code{cnv.data}: numeric matrix, rows = cells/spots, cols = bins.
\item \code{annotation}: \code{data.frame} with at least columns
\code{cell.id} and the column referenced by \code{groupby}.
\item \code{chr_pos}: named numeric/integer vector or list mapping
chromosome names to \strong{0-based} start indices of bins
(i.e., first bin index for chromosome \emph{k} is \code{start+1}).
}}

\item{groupby}{Character scalar; column name in \code{cnv.obj$annotation}
used to color rows (default \code{"cell.label"}).}

\item{color_panel}{Character vector of colors used for group annotation
(recycled to the number of groups).}

\item{min_value, max_value}{Numeric; lower/upper limits for the heatmap
color mapping (default \code{-3} and \code{3}).}

\item{show}{Logical; draw to current device (default \code{TRUE}).}

\item{save}{Logical; if \code{TRUE}, write a file to \code{outfile}.}

\item{outfile}{Character; output filename. If it ends with \code{.pdf} or
\code{.png}, that format is used. Otherwise both PDF and PNG are written
with sensible names.}

\item{auto_size}{Logical; if \code{TRUE} (default) choose device size based on
matrix dimensions.}

\item{width_in, height_in}{Numeric; device width/height in inches used when
\code{auto_size = FALSE}. Ignored otherwise.}

\item{res}{Integer; PNG resolution (dpi) when saving PNG (default \code{300}).}

\item{...}{Passed to \code{ComplexHeatmap::Heatmap()}.}
}
\value{
(Invisibly) a \code{HeatmapList} object.
}
\description{
Draw a CNV heatmap split by chromosomes and annotated by a sample/cell grouping
variable. Designed for objects that provide \code{cnv.data} (cells Ã— bins),
\code{annotation} (with \code{cell.id} and a grouping column), and \code{chr_pos} (per-chromosome
bin start indices). Supports on-screen display and saving to PDF/PNG with
optional auto-sizing based on data dimensions.
}
\examples{
\dontrun{
ht <- cnv_heatmap(
  cnv.obj,
  groupby = "cell.label",
  show = TRUE,
  save = TRUE,
  outfile = "cnv_heatmap.pdf"
)
}


}
