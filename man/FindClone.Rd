% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/run_highSpaClone.R
\name{FindClone}
\alias{FindClone}
\title{Tumor subclone identification with spatial regularization}
\usage{
FindClone(
  obj,
  ref,
  ref.id = NULL,
  tumor = NULL,
  tumor.id = NULL,
  lambda = NULL,
  K = NULL,
  max_iter = 500,
  min_iter = 30,
  epsilon = 5e-04,
  seed = 12345678
)
}
\arguments{
\item{obj}{a highSpaClone object}

\item{ref}{Character vector of reference (normal) labels.}

\item{ref.id}{Optional character vector of reference cell IDs.}

\item{tumor}{Optional character vector of tumor labels; if \code{NULL}, all non-reference cells are used.}

\item{tumor.id}{Optional vector of tumor cell IDs; if both \code{tumor} and \code{tumor.id} are \code{NULL},
all non-reference cells are used.}

\item{lambda}{Numeric; spatial regularization strength passed to \code{run_iter()}.}

\item{K}{Integer; number of subclones (clusters). If \code{NULL}, it should be set by the caller.}

\item{max_iter}{Integer; maximum number of iterations.}

\item{min_iter}{Integer; minimum iterations before early stop.}

\item{epsilon}{Numeric; convergence threshold on relative objective change.}

\item{seed}{Integer; random seed.}
}
\value{
The input \code{obj} with:
\itemize{
\item \verb{@cnv.data}: optimized CNV matrix (tumor cells × genes).
\item \verb{@cluster}: \code{data.frame(cell.id, x, y, cell.label)} where \code{cell.label} ∈ {\code{"Clone 1"}, …, \code{"Clone K"}}.
}
}
\description{
Tumor subclone identification with spatial regularization
}
\section{Convergence and stopping}{

Same as \code{FindTumor()}: early stop on relative improvement < \code{epsilon} after \code{min_iter},
stop on objective increase, or stop at \code{max_iter}.
}

\examples{
\dontrun{
obj <- FindClone(
  obj,
  ref = c("B cells", "T cells"),
  K = 3,
  lambda = 1,
  max_iter = 500,
  min_iter = 30
)
table(obj@cluster$cluster)
}

}
