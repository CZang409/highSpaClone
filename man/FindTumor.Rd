% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/run_highSpaClone.R
\name{FindTumor}
\alias{FindTumor}
\title{Tumor region annotation using reference (normal) cells}
\usage{
FindTumor(
  obj,
  ref,
  lambda = 1/1000,
  K = 2,
  max_iter = 500,
  min_iter = 30,
  epsilon = 5e-04,
  seed = 12345678
)
}
\arguments{
\item{obj}{A highSpaClone object}

\item{ref}{Character vector of reference (normal) cell-type labels matching \code{obj@annotation$cell.label}.}

\item{lambda}{Numeric; spatial regularization strength passed to \code{run_iter()}.}

\item{K}{K=2.}

\item{max_iter}{Integer; maximum number of outer iterations.}

\item{min_iter}{Integer; minimum number of iterations before allowing early stop.}

\item{epsilon}{Numeric; convergence threshold on relative objective change.}

\item{seed}{Integer; random seed used in k-means initialization/updates.}
}
\value{
The input \code{obj} with updated fields:
\itemize{
\item \code{obj@cnv.data}: optimized CNV matrix (cells × genes).
\item \code{obj@cluster}: \code{data.frame(cell.id, x, y, cell.label)} with \code{cell.label} ∈ {\code{"Tumor"}, \code{"Other"}}.
}
}
\description{
Tumor region annotation using reference (normal) cells
}
\section{Convergence and stopping}{

Early stop if relative change < \code{epsilon} after \code{min_iter}, or if the objective increases.
If \code{max_iter} is reached without meeting the criterion, a message is printed.
}

\examples{
\dontrun{
obj <- FindTumor(
  obj,
  ref = c("B cells", "T cells"),
  lambda = 1/1000,
  K = 2,
  max_iter = 300,
  min_iter = 30
)
head(obj@cluster)
}

}
